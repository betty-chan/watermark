!function(e){"function"==typeof define&&define.amd?define(e):e()}(function(){"use strict";function t(e){return(t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var e,r;e=window,r=function(){var g,x,e={};function b(){var e=document.getElementById(g.watermark_id);e&&e.parentNode&&e.parentNode.removeChild(e);var t=document.getElementById(g.watermark_parent_node),r=t||document.body,a=Math.max(r.scrollWidth,r.clientWidth),o=Math.max(r.scrollHeight,r.clientHeight),m=0,n=0;r&&(m=r.offsetTop||0,n=r.offsetLeft||0,(g.watermark_parent_width||g.watermark_parent_height)&&(g.watermark_x=g.watermark_x+n,g.watermark_y=g.watermark_y+m));var i,w=document.getElementById(g.watermark_id),d=null;w?w.shadowRoot&&(d=w.shadowRoot):((w=document.createElement("div")).id=g.watermark_id,w.setAttribute("style","pointer-events: none !important; display: block !important"),d="function"==typeof w.attachShadow?w.attachShadow({mode:"open"}):w,(i=r.children)[e=Math.floor(Math.random()*(i.length-1))]?r.insertBefore(w,i[e]):r.appendChild(w)),g.watermark_cols=parseInt((a-g.watermark_x)/(g.watermark_width+g.watermark_x_space));w=parseInt((a-g.watermark_x-g.watermark_width*g.watermark_cols)/g.watermark_cols);g.watermark_x_space=w&&g.watermark_x_space,g.watermark_rows=parseInt((o-g.watermark_y)/(g.watermark_height+g.watermark_y_space));var _,k,s,w=parseInt((o-g.watermark_y-g.watermark_height*g.watermark_rows)/g.watermark_rows);g.watermark_y_space=w&&g.watermark_y_space,_=g.watermark_x+g.watermark_width*g.watermark_cols+g.watermark_x_space*(g.watermark_cols-1),k=g.watermark_y+g.watermark_height*g.watermark_rows+g.watermark_y_space*(g.watermark_rows-1),t||(_+=n,k+=m);for(var l,h,p,c,y=0;y<g.watermark_rows;y++){s=g.watermark_y+(o-k)/2+(g.watermark_y_space+g.watermark_height)*y,t&&(s+=m);for(var f=0;f<g.watermark_cols;f++)c=g.watermark_x+(a-_)/2+(g.watermark_x_space+g.watermark_width)*f,t&&(c+=n),d.appendChild((l=g.watermark_prefix+y+f,h=c,p=s,c=void 0,(c=document.createElement("div")).id=l,c.style.left=h+"px",c.style.top=p+"px",c.appendChild(document.createTextNode(g.watermark_txt)),c.style.MozTransform="rotate(-"+g.watermark_angle+"deg)",c.style.msTransform="rotate(-"+g.watermark_angle+"deg)",c.style.OTransform="rotate(-"+g.watermark_angle+"deg)",c.style.transform="rotate(-"+g.watermark_angle+"deg)",c.style.position="absolute",c.style.overflow="hidden",c.style.zIndex="9999999",c.style.opacity=g.watermark_alpha,c.style.fontSize=g.watermark_fontsize,c.style.fontFamily=g.watermark_font,c.style.color=g.watermark_color,c.style.textAlign="center",c.style.width=g.watermark_width+"px",c.style.height=g.watermark_height+"px",c.style.display="block",c.style["-ms-user-select"]="none",c))}g.monitor&&(w={childList:!0,attributes:!0,subtree:!0,attributeFilter:["style"],attributeOldValue:!0},x.observe(r,w),x.observe(document.getElementById(g.watermark_id).shadowRoot,w))}function E(e){var t,r;g&&1===e.length||1===e.length&&1<=e[0].removedNodes.length?b():(t={width:0,height:0},(r=document.getElementById(g.watermark_parent_node))&&(e=getComputedStyle(r).getPropertyValue("width"),r=getComputedStyle(r).getPropertyValue("height"),e===t.width&&r===t.height||(t.width=e,t.height=r,b())))}return e.init=function(e){var t=e.watermark_id,r=void 0===t?"wm_div_id":t,a=e.watermark_prefix,o=void 0===a?"mask_div_id":a,m=e.watermark_txt,n=void 0===m?"":m,i=e.watermark_x,w=void 0===i?20:i,d=e.watermark_y,_=void 0===d?20:d,k=e.watermark_rows,s=void 0===k?0:k,l=e.watermark_cols,h=void 0===l?0:l,p=e.watermark_x_space,c=void 0===p?50:p,y=e.watermark_y_space,f=void 0===y?50:y,u=e.watermark_font,v=void 0===u?"微软雅黑":u,t=e.watermark_color,a=void 0===t?"black":t,m=e.watermark_fontsize,i=void 0===m?"18px":m,d=e.watermark_alpha,k=void 0===d?.15:d,l=e.watermark_width,p=void 0===l?100:l,y=e.watermark_height,u=void 0===y?100:y,t=e.watermark_angle,m=void 0===t?15:t,d=e.watermark_parent_width,l=void 0===d?0:d,y=e.watermark_parent_height,t=void 0===y?0:y,d=e.watermark_parent_node,y=void 0===d?null:d,d=e.monitor,e=void 0===d||d,d=window.MutationObserver||window.WebKitMutationObserver||window.MozMutationObserver;x=new d(E),g={watermark_id:r,watermark_prefix:o,watermark_txt:n,watermark_x:w,watermark_y:_,watermark_rows:s,watermark_cols:h,watermark_x_space:c,watermark_y_space:f,watermark_font:v,watermark_color:a,watermark_fontsize:i,watermark_alpha:k,watermark_width:p,watermark_height:u,watermark_angle:m,watermark_parent_width:l,watermark_parent_height:t,watermark_parent_node:y,monitor:e},b(),window.addEventListener("onload",b),window.addEventListener("resize",b)},e.remove=function(){x.disconnect(),window.removeEventListener("onload",b),window.removeEventListener("resize",b);var e=document.getElementById(g.watermark_id);e.parentNode.removeChild(e)},e},"function"==typeof define&&define.amd?define([],r()):"object"===("undefined"==typeof module?"undefined":t(module))&&module.exports?module.exports=r():e.watermark=r()});
